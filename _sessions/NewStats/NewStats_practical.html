<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Neue Statistik</title>

<script src="NewStats_practical_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="NewStats_practical_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="NewStats_practical_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="NewStats_practical_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="NewStats_practical_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="NewStats_practical_files/navigation-1.1/tabsets.js"></script>
<link href="NewStats_practical_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="NewStats_practical_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="practical.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "Óâô";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "Óâô";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Neue Statistik</h1>
<h4 class="author"><table style='table-layout:fixed;width:100%;border:0;padding:0;margin:0'>
<col width='10%'>
<col width='10%'>
<tr style="border:none">
<td style="display:block;width:100%;text-align:left;vertical-align:bottom;padding:0;margin:0;border:none" nowrap>
<font style='font-style:normal'>Statistics with R</font><br> <a href='https://therbootcamp.github.io/SmR_2020Mai/'> <i class='fas fa-clock' style='font-size:.9em;' ></i> </a> <a href='https://therbootcamp.github.io'> <i class='fas fa-home' style='font-size:.9em;'></i> </a> <a href='mailto:therbootcamp@gmail.com'> <i class='fas fa-envelope' style='font-size: .9em;'></i> </a> <a href='https://www.linkedin.com/company/basel-r-bootcamp/'> <i class='fab fa-linkedin' style='font-size: .9em;'></i> </a> <a href='https://therbootcamp.github.io'> <font style='font-style:normal'>The R Bootcamp</font> </a>
</td>
<td style="width:100%;vertical-align:bottom;text-align:right;padding:0;margin:0;border:none">
<img src='https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png' style='height:15px;width:80px'/>
</td>
</tr>
</table></h4>

</div>


<p align="center" width="100%">
<a href="https://www.youtube.com/watch?v=fn7-JZq0Yxs"><br />
<img src="image/psi.jpg" alt="Trulli" style="width:100%"></a> <br> <font style="font-size:10px">Steven Tash as a psi-test subject in Ghostbusters, from <a href="https://www.imdb.com/name/nm0850865/"> imdb.com </a> </font>
</p>
<div id="section" class="section level1 tabset">
<h1></h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p align="center">
<p>‚ÄúThe term psi denotes anomalous processes of information or energy transfer that are currently unexplained in terms of known physical or biological mechanisms. Two variants of psi are precognition (conscious cognitive awareness) and premonition (affective apprehension) of a future event that could not otherwise be anticipated through any known inferential process.‚Äù<br><i>Daryl J. Bem, professor emeritus, Cornell University</i></p>
</p>
<p>In diesem Practical, analysierst du die Daten von Daryl Bem`s ber√ºchtigter Studie √ºber menschliche <em>psi</em>-F√§higkeieten und √ºbst w√§hrendessen neue und neu-erlangten Statistikf√§higkeiten.</p>
<p>Am Ende des Practicals wirst du wissen‚Ä¶</p>
<ol style="list-style-type: decimal">
<li>Wie du <i>p</i>-Hacking betreibst.</li>
<li>Wie du sample sizes bestimmsts.</li>
<li>Wie du Konfidenzintervalle berechnest.</li>
<li>Wie du Bayesianische Statistiken rechnest.</li>
</ol>
</div>
<div id="aufgaben" class="section level2">
<h2>Aufgaben</h2>
<div id="a---setup" class="section level3">
<h3>A - Setup</h3>
<ol style="list-style-type: decimal">
<li><p>√ñffne dein <code>TheRBootcamp</code> R project. Es sollte die Ordner <code>1_Data</code> und <code>2_Code</code> enthalten. Stelle sicher, dass du alle Datens√§tze, welche im <code>Datens√§tze</code> Tab aufgelisted sind, in deinem <code>1_Data</code> Ordner hast.</p></li>
<li><p>√ñffne ein neues R Skript. Schreibe deinen Namen, das Datum und ‚ÄúNeue Statistik Practical‚Äù als Kommentare an den Anfang des Skripts.</p></li>
</ol>
<pre class="r"><code>## NAME
## DATUM
## Neue Statistik Practical</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Speichere das neue Skript unter dem Namen <code>neue_statistik_practical.R</code> im <code>2_Code</code> Ordner.</p></li>
<li><p>Lade die n√∂tigen Pakete. Siehe unten.</p></li>
</ol>
<pre class="r"><code># Lade die n√∂tigen Pakete
library(tidyverse)
library(pwr)
library(rstanarm)
library(BayesFactor)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Verwende die <code>read_csv()</code> Funktion um <code>psi1</code>, die Daten des ersten Experiments, und <code>psi2</code>, die Daten des zweiten Experiments einzulesen.</li>
</ol>
<pre class="r"><code># Lade die Daten
psi1 &lt;- read_csv(file = &quot;1_Data/psi_exp1.csv&quot;)
psi2 &lt;- read_csv(file = &quot;1_Data/psi_exp2.csv&quot;)</code></pre>
<ol start="6" style="list-style-type: decimal">
<li><p>Printe die Datens√§tze.</p></li>
<li><p>Verwende <code>names(XX)</code>, <code>summary(XX)</code>, und <code>View(XX)</code> um einen weiteren √úberblick √ºber die Daten zu bekommen.</p></li>
<li><p>Wiederum, f√ºhre den Code unten aus um sicherzustellen, dass alle <code>character</code> Variablen als Faktoren vorliegen, was den statistischen Modellen hilft kategoriale Variablen richtig zu interpretieren.</p></li>
</ol>
<pre class="r"><code># Konvertiere alle character zu factor
psi1 &lt;- psi1 %&gt;% mutate_if(is.character, factor)
psi2 &lt;- psi2 %&gt;% mutate_if(is.character, factor)</code></pre>
</div>
<div id="b---psi-hacking-wettbewerb" class="section level3">
<h3>B - p(si)-Hacking Wettbewerb</h3>
<ol style="list-style-type: decimal">
<li>Der erste Abschnitt besteht aus zwei <i>p</i>-Hacking Wettbewerben! Der Wettbewerb endet in</li>
</ol>
<font style="font-size:32px">
<p id="demo" align="center">
</p>
<p></font></p>
<script>
// Set the date we're counting down to
var countDownDate = new Date("May 9, 2020 16:45:00").getTime();

// Update the count down every 1 second
var x = setInterval(function() {

  // Get todays date and time
  var now = new Date().getTime();

  // Find the distance between now and the count down date
  var distance = countDownDate - now;

  // Time calculations for days, hours, minutes and seconds
  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
  var seconds = Math.floor((distance % (1000 * 60)) / 1000);

  // Display the result in the element with id="demo"
  document.getElementById("demo").innerHTML = days + "d " + hours + "h "
  + minutes + "m " + seconds + "s ";

  // If the count down is finished, write some text 
  if (distance < 0) {
    clearInterval(x);
    document.getElementById("demo").innerHTML = "EXPIRED";
  }
}, 1000);
</script>
<ol start="2" style="list-style-type: decimal">
<li><p>Das Zeil beider Wettbewerbe ist es den kleinstm√∂glichen <i>p</i>-Wert durch das fortw√§hrende Massieren der experimentellen Daten von Bem‚Äôs zu extrahieren. Finde daf√ºr bis zu drei Analysen, die zeigen, dass a) Menschen <em>psi</em>-F√§higkeiten besitzen, d.h., dass die <code>hit_rate</code> h√∂her als Chance ist und b) dass es andere Variablen gibt die <em>psi</em>-F√§higkeiten pr√§dizieren, was ebenso ein Beleg f√ºr die Existenz solcher F√§higkeiten w√§re. Es gibt keine Regeln, ausser dass <code>hit_rate</code> als Kriterium zu w√§hlen ist. Du kannst jeden m√∂glichen Test verwenden. Dir ist es auch erlaubt nur Komponenten der Daten mit <code>data %&gt;% filter(condition)</code> auszuw√§hlen.</p></li>
<li><p>F√ºr jede der beiden Wettbewerbe - jeweils ein Wettbewerb pro Experiment - darfst du drei Ergebnisse einreichen. Ihr k√∂nnt alleine arbeiten oder euch zusammenschliessen. Mehr Informationen √ºber den Datensatz findet ihr unter dem <em>Datasets</em> tab. Die Person oder Gruppe mit dem niedrigsten <i>p</i>-Wert gewinnt üç´üç´üç´.</p></li>
<li><p>Reiche die Ergebnisse ein √ºber:</p></li>
</ol>
<table align="center">
<tr>
<td>
Wettbewerb 1
</td>
<td>
<a href="https://docs.google.com/forms/d/e/1FAIpQLScw5MmBX9wnmv3YO7SzdqdWMWSSwdCjWu0EUM2kurLRJLpEOQ/viewform?usp=sf_link"><font style="font-size:18px;font-weight:900">Einreichen</font></a>
</td>
</tr>
<td>
Wettbewerb 2
</td>
<td>
<a href="https://docs.google.com/forms/d/e/1FAIpQLSeJDsFtOSCFx7KmjzG4qq2bBMArPMWdaFKmUOqFfthspDhshQ/viewform?usp=sf_link"><font style="font-size:18px;font-weight:900">Einreichen</font></a>
</td>
</tr>
</table>
</div>
<div id="c---poweranalyse" class="section level3">
<h3>C - Poweranalyse</h3>
<ol style="list-style-type: decimal">
<li>Bem‚Äôs erste Analyse in seinem paper ist, ob <code>hit_rate</code> gr√∂sser ist als <code>50%</code>. F√ºr diese Bedingung (<code>Bedingung == 'erotic'</code>) hat Bem eine durchschnittliche Trefferrate von <code>53.13%</code> beobachtet. Bestimme f√ºr Experiment 1, welcher Cohen‚Äôs <em>d</em> Wert der implizierten Abweichung von <code>3.13%</code>-Punkte von der Trefferrate unter H0, n√§mlich <code>50%</code>, entspricht. Benutze das Template.</li>
</ol>
<pre class="r"><code># Extrahiere die Trefferraten f√ºr erotic
Trefferrate_erotic &lt;- psi1 %&gt;% filter(Bedingung == &quot;erotic&quot;) %&gt;% pull(Trefferrate)

# Berechne die Abweichung von H0
Trefferrate_erotic_delta &lt;- mean(XX) - 50

# Berechne d
d &lt;- Trefferrate_erotic_delta / sd(XX)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Ein Cohen‚Äôs d von <code>.25</code> wird allgemein als klein, aber bedeutsam angesehen. Nimm nun die Perspektive eines rivalisierenden Forschers ein, der Bem‚Äôs Effekt von <code>d = .25</code> in einer neuen Studie mit einer Falsch-Positiv-Rate von <span class="math inline">\(\alpha = .05\)</span> einer hohen Power von <span class="math inline">\(power = 1-\beta = .95\)</span> replizieren m√∂chtee. Welche Stichprobengr√∂sse w√§re n√∂tig? Verwende das Template.</li>
</ol>
<pre class="r"><code># N um d=.25, alpha = .05, power = .95
stichprobe &lt;- pwr.t.test(d = XX, 
                         sig.level = XX, 
                         power = XX, 
                         alternative = &quot;greater&quot;)
stichprobe</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Laut Poweranalyse w√§re eine Stichprobe von 347 Individuen n√∂tig. Versuche dies einmal mit der <code>plot.power.htest()</code>-Funktion zu visualisieren. Wende sie einfach auf das <code>stichprobe</code> Objekt an.</p></li>
<li><p>Mittels des Plots k√∂nnt ihr nun auch evaluieren, wie gross die Power von Bem‚Äôs urspr√ºnglicher Studie war. In Bem‚Äôs <code>'erotic'</code> condition waren <span class="math inline">\(r length(Trefferrate_erotic)\)</span> Beobachtungen. Finde den entsprechenden Punkt auf der x-Achse und gehe dann nach oben um die dazugeh√∂rige Power zu finden. Alternativ kannst du nochmals die <code>pwr.t.test()</code> Funktion verwenden und anstatt <code>power</code> die Stichprobengr√∂sse <code>n</code> definieren. Siehe Template.</p></li>
</ol>
<pre class="r"><code># Bems post-hoc power
power &lt;- pwr.t.test(n = XX, 
                    d = .25, 
                    sig.level = .05, 
                    alternative = &quot;greater&quot;)
power</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><p>Die letzte Analyse, das bestimmen der Power f√ºr einen gegebenen Effekt und Stichprobengr√∂sse nennt man eine Post-hoc Poweranalyse, welche nicht mit einer eigentlichen Poweranalyse verwechselt werden darf. In Bem‚Äôs Fall war die Power <code>.547</code>, das heisst das Bem nur ungef√§hr eine 50/50 Chance hatte einen Effekt von der gefundenen St√§rke zu beobachten. √úberpr√ºfe nun was gewesen w√§re, wenn der Effekt klein gewesen w√§re, d.h., <code>d = .1</code>. Wiederhole die Powerberechnung f√ºr Bem‚Äôs Stichprobengr√∂sse und berechne die Stichprobengrlsse die n√∂tig ist f√ºr eine <span class="math inline">\(power = 1-\beta = .95\)</span>.</p></li>
<li><p>F√ºr einen kleinen Effekt, welchen man vielleicht h√∂chstens erwarten w√ºrde f√ºr etwas so ungew√∂hnliches wie menschliche <em>psi</em>-F√§higkeiten, hatte Bem‚Äôs Studie nur eine power von <code>17.4%</code> und die Stichprobe die f√ºr eine hohe power notwendig war lag oberhalb von 2000 Personen. Das bedeutet, dass Bem entweder wusste, dass er einen gr√∂sseren Effekt beobachten w√ºrde oder, dass er eher schlechte Studienplanung betrieben hat.</p></li>
</ol>
</div>
<div id="d---konfidenzintervalle" class="section level3">
<h3>D - Konfidenzintervalle</h3>
<ol style="list-style-type: decimal">
<li>Konfidenzintervalle sind ein andere Weg Signifikanztests durchzuf√ºhren, welcher eher auf Sch√§tzung als auf Testung von Effekten beruht. Die grundlegende Idee ist, dass man die Sch√§tzgr√∂ssen (z.B. Regressionsgewichte) nicht durch den Standardfehler teilt, sondern den Standardfehler verwendet um eine Spannweite um die Sch√§tzgr√∂ssen aufzuspannen. Rechnen wir zun√§chst ein einfaches lineares Modell f√ºr <code>psi1</code>, dass die <code>Trefferrate</code> durch die <code>Bedingung</code> vorhersagt.</li>
</ol>
<pre class="r"><code># Regression 
psi_lm &lt;- lm(XX ~ XX, data = XX)

# Testergebnisse
summary(psi_lm)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Verwende nun die <code>confint()</code> Funktion um die Konfidenzintervalle f√ºr die Regression, d.h., den Intercept und das Gewicht f√ºr <code>Bedingung</code>, zu bestimmen.</li>
</ol>
<pre class="r"><code># Konfidenzintrval
confint(XX)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Das Konfidenezinterval f√ºr den Intercept lag zwischen <code>47.47</code> und <code>52.19</code>, w√§hrend das Interval f√ºr das Gewicht zwischen <code>-.03</code> und <code>6.64</code>. Beide Konfidenzintervalle enthalten also die NUll. Das heisst inbesondere, dass der obgleich der Mittelwert f√ºr die Erotic-Bedingung signifikant von <code>50%</code> verschieden ist die beiden Bedingungen sich nicht signifikant unterscheiden. Beginne nun die das Konfidenzinterval f√ºr das Gewicht nachzubauen. Extrahiere daf√ºr zun√§chst das Gewicht und den entsprechenden Standardfehler.</li>
</ol>
<pre class="r"><code># Gewicht b und Standardfehler se
b &lt;- summary(psi_lm)$coef[2, 1]
se &lt;- summary(psi_lm)$coef[2, 2]</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Jetzt ben√∂tigst du nur noch die entsprechenden t-Wert um das Konfidenzintervall auzuspanne. Da das Konfidenzinterval in beide Richtungen zu gleichen Teilen aufgespannt werden soll such wir nicht den t-Wert f√ºr <span class="math inline">\(1-\alpha\)</span> sondern f√ºr <span class="math inline">\(1-\frac{\alpha}{2}\)</span> und <span class="math inline">\(\frac{\alpha}{2}\)</span>, d.h., wir suchen die kritischen t-Werte f√ºr einen zweiseitigen Test. Locate these values in the figure below.</li>
</ol>
<p><img src="image/tdistr.png"></img></p>
<ol start="6" style="list-style-type: decimal">
<li><p>We can calculate the precise t-values corresponding to certain probabilities using the cumulative distribution function of t <code>qt(p = XX, df = YY)</code>. To use it, you must provide the proportion <code>p</code> of t-values that should be smaller than the target value and the degrees of freedom <code>df</code>, which in this case must be set to <code>n-1</code>. Determine <span class="math inline">\(t_{2.5\%}\)</span> and <span class="math inline">\(t_{97.5\%}\)</span> and store them as <code>t.25</code> and <code>t97.5</code>.</p></li>
<li><p>Compare the two t-values. Anything surprising? Given the symmetric nature of the t-distribution the two values are their respective mirror image. Ok, now you have all the ingredients that you need to construct a confidence interval. To calculate the lower bound, you want to move exactly <code>t.25</code> times the standard error to the left of the mean hit rate difference. And to calculate the bound, you want to move exactly <code>t97.5</code> times the standard error to the right of the mean hit rate difference. Do this and name the lower and upper bounds <code>hit_rate_lowerb</code> and <code>hit_rate_upperb</code>.</p></li>
<li><p>Now compare your calculated values against the confidence interval determined by the t-test. Are they the same? The confidence interval is many ways the better alternative to the classic inferential test because it prefers more information. A test is just significant or not. The confidence interval reveals this information too by including the 0 or not, but it also reveals the oftentimes considerable uncertainty inherent in our estimate, which is otherwise easily forgotten.</p></li>
<li><p>Play around with the confidence intervals. How do the bounds change, when you choose higher (e.g., 99%) or lower (90%) percentages.</p></li>
</ol>
</div>
<div id="x---advanced-bayesian-statistics" class="section level3">
<h3>X - Advanced: Bayesian statistics</h3>
<ol style="list-style-type: decimal">
<li>Bayesian statistics have become readily available in R mainly through two R packages <code>rstanarm</code> and <code>Bayesfactor</code>. Both packages are great and allow you to do almost anything, but they do follow a slightly different philosophy. Let‚Äôs begin with <code>rstanarm</code>. Use the template below to run a regression predicting <code>hit_rate</code> by <code>gender</code> and <code>condition</code>.</li>
</ol>
<pre class="r"><code># Bayesian regression predicting hit_rate by gender and condition
bm1 &lt;- stan_glm(formula = hit_rate ~ gender + condition, 
                data = psi1)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Print the object and inspect the output. You‚Äôll see it looks different than the output of a regular regression. Focusing only on the part after the separating hyphens, there are three main parts:</li>
</ol>
<ul>
<li><p>The first part shows the coefficients and their standard deviation. Different from a regular regression output, we do not receive any statistics or significance values. Moreover estimates are labeled Median and MAD_SD. This is because of the fact that in Bayesian statistics, we can more or less choose which centrality measure to compute from the posterior distribution. <code>rstanarm</code> chooses the median, because the median is typically more robust.</p></li>
<li><p>The second part labeled <em>Auxiliary parameter(s)</em> lists another set of estimates (in this case only 1), which had to be computed in order to be able to fit the model. In this case this is a single standard deviation for the residual distribution (here you can see the importance of the homoscedascity assumption. Without it a lot more sigmas would have to be estimated).</p></li>
<li><p>The third part labeled <em>Sample avg. posterior predictive distribution of y</em> shows the mean value predicted by the model, which is, more or less, the average of the fitted values.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>In order to make statistical decisions, Bayesian statistics commonly relies on intervals, which in Bayesian statistics are called <em>credible interval</em> rather than <em>confidence interval</em>. Credible intervals truly provide the ranges that encompass the true value with 95% probability, which cannot strictly be said about confidence intervals. You can compute these intervals using the <code>posterior_interval()</code> function on the <code>bm1</code> object.</p></li>
<li><p>Now let‚Äôs run the same analysis using the <code>BayesFactor</code> package using the <code>regressionBF</code> function.</p></li>
</ol>
<pre class="r"><code># Bayesian regression predicting hit_rate by gender and condition
psi1$gender_dummy &lt;- as.numeric(psi1$gender == &#39;Male&#39;)
psi1$condition_dummy &lt;- as.numeric(psi1$condition == &quot;erotic&quot;)

bm2 &lt;- regressionBF(formula = hit_rate ~ gender_dummy + condition_dummy, 
                    data = psi1)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><p>Print <code>bm2</code> and inspect the output. You‚Äôll see it‚Äôs very different. The <code>BayesFactor</code> focuses more on model comparisons than parameter estimation. Accordingly, the output informs you about a model comparison, in this case, between the regression model provided and a model only containing an intercept as a predictor, the <code>Intercept only</code> model. The results are what is known <em>BayesFactor</em>s. The <code>BayesFactor</code> quantifies the amount of evidence that the data provides in favor of the model in question, relative to the comparison model. Values larger than 1 mean that the data favors the model in question, although only values above 10 are considered meaningful. Values lower than 1 indicate that the comparison model is actually more likely. The output presents results independently for each predictor and their combination. So what is it in this case? Are the predictors any good.</p></li>
<li><p>The previous result illustrates one of several major benefits of Bayesian statistics and that is to be able to specify the evidence in favor of the Null-hypothesis. In general, everything can be done with either package. Go explore.</p></li>
</ol>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<pre class="r"><code># power analysis -----------

# N needed for one-sided test with a mean difference of
# .3 standard deviations, a false positive error rate (sig.level)
# of .05, and power of .95
pwr.t.test(d = .3, 
           sig.level = .05, 
           power = .95, 
           alternative = &quot;greater&quot;)

# Power obtained for one-sided test with mean difference of
# .3 standard deviations, a false positive error rate (sig.level)
# of .05, and a sample size of 100
pwr.t.test(n = 100,
           d = .3, 
           sig.level = .05, 
           power = .95, 
           alternative = &quot;greater&quot;)


# confidence intervals -----------

#  split data (not strictly necessary)
mpg_suv     &lt;- mpg %&gt;% filter(class == &#39;suv&#39;)
mpg_compact &lt;- mpg %&gt;% filter(class == &#39;compact&#39;)

# mean difference and pooled standard deviation
mpg_diff = mean(mpg_suv$hwy) - mean(mpg_compact$hwy)
mpg_diff_sd = sqrt((var(mpg_suv$hwy) + var(mpg_compact$hwy))/2)
df = length(mpg_suv$hwy) + length(mpg_compact$hwy) - 2
mpg_diff_se = mpg_diff_sd / sqrt(df)

# upper and lower bounds
mpg_diff + qt(.025, df) * mpg_diff_se
mpg_diff + qt(.975, df) * mpg_diff_se

# both at the same time
mpg_diff + qt(.975, df) * mpg_diff_se * c(-1,1)

# Bayesian regression -----------

# using rstanarm
bm1 &lt;- stan_glm(hwy ~ displ, data = mpg)

# rstanarm credible intervals
posterior_interval(bm1)

# using BayesFactor
bm2 &lt;- regressionBF(hwy ~ displ, data = mpg)

# sample from posterior
posterior(bm2, iterations = 1000)</code></pre>
</div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
<table>
<thead>
<tr class="header">
<th align="left">File</th>
<th align="left">Rows</th>
<th align="left">Columns</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://therbootcamp.github.io/SwR_2019Apr/1_Data/psi_exp1.csv">psi_exp1.csv</a></td>
<td align="left">200</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left"><a href="https://therbootcamp.github.io/SwR_2019Apr/1_Data/psi_exp2.csv">psi_exp2.csv</a></td>
<td align="left">150</td>
<td align="left">5</td>
</tr>
</tbody>
</table>
<p>The data sets stem from actual (para-) psychological investigation of people‚Äôs ability to <a href="https://therbootcamp.github.io/SwR_2019Apr/_sessions/NewStats/literature/Bem_Psi_2011.pdf">‚ÄúFeel the future‚Äù</a>. The infamous study published in a respected Social Psychology journal was one of the main reasons that triggered the replication crisis and the associated efforts for better scientific practice in Psychology and beyond. The data sets contain the data of the first two experiments. Experiment 1 investigated whether people can successfully (better than chance) predict behind which of two occluding curtains a picture is hiding as a function of, among other things, whether the picture has erotic content. Experiment 2 is an attempt to replicate study 2. Both studies also measures how stimulus seeking (a variant of extraversion) individuals were, to see whether this influences individuals <em>psi</em> ability.</p>
<div id="variable-description" class="section level4">
<h4>Variable description</h4>
<table>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>gender</code></td>
<td align="left">The gender of the participant.</td>
</tr>
<tr class="even">
<td align="left"><code>age</code></td>
<td align="left">The age of the participant.</td>
</tr>
<tr class="odd">
<td align="left"><code>stimulus_seeking</code></td>
<td align="left">The degree of stimulus-seeking exhibited by the participant.</td>
</tr>
<tr class="even">
<td align="left"><code>hour_of_day</code></td>
<td align="left">The hour of day at which the participant was tested.</td>
</tr>
<tr class="odd">
<td align="left"><code>condition</code></td>
<td align="left">The study condition: ‚Äúerotic‚Äù or ‚Äúcontrol‚Äù (only psi1)</td>
</tr>
<tr class="even">
<td align="left"><code>depicted_gender</code></td>
<td align="left">The gender on the presented photo: ‚ÄúFemale‚Äù or ‚ÄúMale‚Äù (only psi1)</td>
</tr>
<tr class="odd">
<td align="left"><code>n_trials</code></td>
<td align="left">The number of choices made.</td>
</tr>
<tr class="even">
<td align="left"><code>hit_rate</code></td>
<td align="left">%-correct choices (with regard to showing <em>psi</em>).</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<div id="packages" class="section level3">
<h3>Packages</h3>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Installation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidyverse</code></td>
<td align="left"><code>install.packages(&quot;tidyverse&quot;)</code></td>
</tr>
<tr class="even">
<td align="left"><code>pwr</code></td>
<td align="left"><code>install.packages(&quot;pwr&quot;)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>rstanarm</code></td>
<td align="left"><code>install.packages(&quot;rstanarm&quot;)</code></td>
</tr>
</tbody>
</table>
</div>
<div id="functions-1" class="section level3">
<h3>Functions</h3>
<table>
<colgroup>
<col width="7%" />
<col width="12%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>pwr.t.test</code></td>
<td align="left"><code>pwr</code></td>
<td align="left">t-test power analyses</td>
</tr>
<tr class="even">
<td align="left"><code>plot.power.htest</code></td>
<td align="left"><code>pwr</code></td>
<td align="left">Plot power analyses</td>
</tr>
<tr class="odd">
<td align="left"><code>qt</code>, <code>anorm</code>, <code>qF</code>, etc.</td>
<td align="left"><code>stats</code></td>
<td align="left">Functions needed to determine confidence intervals</td>
</tr>
<tr class="even">
<td align="left"><code>stan_lm</code></td>
<td align="left"><code>rstanarm</code></td>
<td align="left">Bayesian regression using <code>rstanarm</code></td>
</tr>
<tr class="odd">
<td align="left"><code>posterior_interval</code></td>
<td align="left"><code>rstanarm</code></td>
<td align="left">Bayesian credible interval using <code>rstanarm</code></td>
</tr>
<tr class="even">
<td align="left"><code>regressionBF</code></td>
<td align="left"><code>BayesFactor</code></td>
<td align="left">Bayesian regression using <code>BayesFactor</code></td>
</tr>
<tr class="odd">
<td align="left"><code>posterior</code></td>
<td align="left"><code>BayesFactor</code></td>
<td align="left">Sample from the posterior using <code>BayesFactor</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<div id="vignettes" class="section level3">
<h3>vignettes</h3>
<p>Find vignettes to these packages: <a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html">pwr</a>, <a href="http://mc-stan.org/rstanarm/articles/rstanarm.html">rstanarm</a>, <a href="https://richarddmorey.github.io/BayesFactor/">BayesFactor</a></p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
