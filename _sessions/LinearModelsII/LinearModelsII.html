<!DOCTYPE html>
<html>
  <head>
    <title>Linear Models II</title>
    <meta charset="utf-8">
    <meta name="author" content="Statistics with R   Basel R Bootcamp" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="baselrbootcamp.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Linear Models II
### Statistics with R<br> <a href='https://therbootcamp.github.io'> Basel R Bootcamp </a> <br> <a href='https://therbootcamp.github.io/SwR_2019Apr/'> <i class='fas fa-clock' style='font-size:.9em;'></i> </a>  <a href='https://therbootcamp.github.io'> <i class='fas fa-home' style='font-size:.9em;' ></i> </a>  <a href='mailto:therbootcamp@gmail.com'> <i class='fas fa-envelope' style='font-size: .9em;'></i> </a>  <a href='https://www.linkedin.com/company/basel-r-bootcamp/'> <i class='fab fa-linkedin' style='font-size: .9em;'></i> </a>
### April 2019

---


layout: true

&lt;div class="my-footer"&gt;
  &lt;span style="text-align:center"&gt;
    &lt;span&gt; 
      &lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png" height=14 style="vertical-align: middle"/&gt;
    &lt;/span&gt;
    &lt;a href="https://therbootcamp.github.io/"&gt;
      &lt;span style="padding-left:82px"&gt; 
        &lt;font color="#7E7E7E"&gt;
          www.therbootcamp.com
        &lt;/font&gt;
      &lt;/span&gt;
    &lt;/a&gt;
    &lt;a href="https://therbootcamp.github.io/"&gt;
      &lt;font color="#7E7E7E"&gt;
       Statistics with R | April 2019
      &lt;/font&gt;
    &lt;/a&gt;
    &lt;/span&gt;
  &lt;/div&gt; 

---









# Linear Model Applications

.pull-left5[

&lt;p style="padding-bottom:20px"&gt;&lt;u&gt;Linear Model Equation&lt;/u&gt;&lt;/p&gt;

`$$\Large y = \beta_{0} + \beta_{1}x_{1} + \beta_{2} x_{2} +  ... + \beta_{n}x_{n} + \epsilon$$`

&lt;p style="padding-top:20px"&gt;&lt;u&gt;Hypothesis tests are linear models!&lt;/u&gt;&lt;br&gt;&lt;br&gt;

In fact, many of your favorite hypothesis tests, including &lt;high&gt;t-tests&lt;/high&gt;, &lt;high&gt;correlation tests&lt;/high&gt;, and &lt;high&gt;ANOVAs&lt;/high&gt; can all be expressed as linear models! &lt;br&gt;&lt;br&gt;

This means that you can use the `lm()` or `glm()` function to do all of these tests!&lt;br&gt;&lt;br&gt;

However, R also has special &lt;high&gt;hypothesis test functions&lt;/high&gt; with more user-friendly outputs.&lt;br&gt;&lt;br&gt;
&lt;/p&gt;

]

.pull-right4[

&lt;p align = "center"&gt;
  &lt;img src="image/linear_model_vendiagram.png" height="430px"&gt;
&lt;/p&gt;

]


---

# Linear Model Applications

.pull-left5[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" /&gt;

Many of these tests assume your dependent variable is &lt;high&gt;normally distributed&lt;/high&gt;. What differentiates these tests is typically the &lt;high&gt;scale of your independent variable&lt;/high&gt;.

&lt;u&gt; Types of predictor variables &lt;/u&gt;

&lt;table style="cellspacing:0; cellpadding:0; border:none" width=100%&gt;
  &lt;col width="10%"&gt;
  &lt;col width="45%"&gt;
  &lt;col width="40%"&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Scale&lt;/b&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Examples&lt;/b&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Nominal
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    A discrete category without order
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    Sex, College, Favorite Color
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Ratio
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    A continuous number
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    Income, Height, Weight
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;/table&gt;


]

.pull-right4[

&lt;p align = "center"&gt;
  &lt;img src="image/linear_model_vendiagram.png" height="430px"&gt;
&lt;/p&gt;

]

---

# Null hypothesis testing

.pull-left45[

Null hypothesis testing is a statistical framework where one hypothesis (H&lt;sub&gt;0&lt;/sub&gt;) is tested to defend the other, alternative hypothesis (H&lt;sub&gt;1&lt;/sub&gt;).

&lt;table style="cellspacing:0; cellpadding:0; border:none; padding-top:10px" width=100%&gt;
  &lt;col width="16%"&gt;
  &lt;col width="44%"&gt;
  &lt;col width="40%"&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Hypothesis&lt;/b&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;  
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Example&lt;/b&gt;
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Null (H&lt;sub&gt;0&lt;/sub&gt;)
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    A proposed effect &lt;high&gt;does not exist&lt;/high&gt; and variation &lt;high&gt;is not systematic&lt;/high&gt;.
  &lt;/td&gt;  
  &lt;td bgcolor="white"&gt;
    Drug and placebo have the same effect.
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Alternative (H&lt;sub&gt;1&lt;/sub&gt;)
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    A proposed effect &lt;high&gt;does exist&lt;/high&gt; and variation &lt;high&gt;is systematic&lt;/high&gt;
  &lt;/td&gt;  
  &lt;td bgcolor="white"&gt;
    Drug and placebo do *not* have the same effect
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;/table&gt;


]


.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" /&gt;


]


---

# Correlation test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Does Y tend to change when X changes?&lt;/b&gt;&lt;/font&gt;

Conduct a &lt;high&gt;correlation test&lt;/high&gt; when you have 2 continuous, Normally distributed independent variables X and Y.

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

`$$\LARGE Y=\beta_{0}+\beta_{1}x$$`

`$$\LARGE \beta_{1}=\rho\frac{\sigma_{y}}{\sigma_{x}}$$`

&lt;table style="cellspacing:0; cellpadding:0; border:none; padding-top:10px" width=100%&gt;
  &lt;col width="15%"&gt;
  &lt;col width="85%"&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &amp;#x3C1;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    The &lt;high&gt;population correlation&lt;/high&gt; between x and Y
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;r&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    The &lt;high&gt;sample correlation&lt;/high&gt; between x and Y
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;/table&gt;

]

.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /&gt;


]


---

# Correlation test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Correlation Coefficient&lt;/b&gt;&lt;/font&gt;

&lt;p align = "center"&gt;
  &lt;img src="image/correlation_coefficien_diagram_cropped.png" width="100%" style="padding-bottom:15px"&gt;
&lt;/p&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Hypotheses&lt;/b&gt;&lt;/font&gt;

Null: `\(H_{0}:\rho  = 0\)`, "There &lt;high&gt;is no&lt;/high&gt; correlation in the population"

Alternative: `\(H_{A}:\rho  \neq 0\)`, "There &lt;high&gt;is a &lt;/high&gt; (non-zero) correlation in the population!"

]

.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;


]


---

# Correlation test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Correlation Coefficient&lt;/b&gt;&lt;/font&gt;

&lt;p align = "center"&gt;
  &lt;img src="image/correlation_coefficien_diagram_cropped.png" width="100%" style="padding-bottom:15px"&gt;
&lt;/p&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Hypotheses&lt;/b&gt;&lt;/font&gt;

Null: `\(H_{0}:\rho  = 0\)`, "There &lt;high&gt;is no&lt;/high&gt; correlation in the population"

Alternative: `\(H_{A}:\rho  \neq 0\)`, "There &lt;high&gt;is a &lt;/high&gt; (non-zero) correlation in the population!"

]

.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---


# Correlation test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Correlation Coefficient&lt;/b&gt;&lt;/font&gt;

&lt;p align = "center"&gt;
  &lt;img src="image/correlation_coefficien_diagram_cropped.png" width="100%" style="padding-bottom:15px"&gt;
&lt;/p&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Hypotheses&lt;/b&gt;&lt;/font&gt;

Null: `\(H_{0}:\rho  = 0\)`, "There &lt;high&gt;is no&lt;/high&gt; correlation in the population"

Alternative: `\(H_{A}:\rho  \neq 0\)`, "There &lt;high&gt;is a &lt;/high&gt; (non-zero) correlation in the population!"

]

.pull-right45[


```r
# Relationship between age and income?

inc_ht &lt;- cor.test(formula = ~ age + income,
                   data = baselers)

# Print result
inc_ht
```

```
## 
## 	Pearson's product-moment correlation
## 
## data:  age and income
## t = 180, df = 8500, p-value &lt;2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8882 0.8968
## sample estimates:
##    cor 
## 0.8926
```


]

---

# Correlation test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Correlation Coefficient&lt;/b&gt;&lt;/font&gt;

&lt;p align = "center"&gt;
  &lt;img src="image/correlation_coefficien_diagram_cropped.png" width="100%" style="padding-bottom:15px"&gt;
&lt;/p&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Hypotheses&lt;/b&gt;&lt;/font&gt;

Null: `\(H_{0}:\rho  = 0\)`, "There &lt;high&gt;is no&lt;/high&gt; correlation in the population"

Alternative: `\(H_{A}:\rho  \neq 0\)`, "There &lt;high&gt;is a &lt;/high&gt; (non-zero) correlation in the population!"

]

.pull-right45[




```r
# Show all named elements
names(inc_ht)
```

```
## [1] "statistic"   "parameter"  
## [3] "p.value"     "estimate"   
## [5] "null.value"  "alternative"
## [7] "method"      "data.name"  
## [9] "conf.int"
```

```r
# Show estimated correlation coefficient
inc_ht$estimate
```

```
##    cor 
## 0.8926
```

```r
# Show p-value
inc_ht$p.value
```

```
## [1] 0
```

]

---

# t-test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Does the mean of group A differ from group B?&lt;/b&gt;&lt;/font&gt;

Conduct a &lt;high&gt;t-test&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;2 levels&lt;/high&gt; A and B

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

`$$\LARGE Y=\beta_{0}+\beta_{1}x$$`

`$$\beta_{0} = Mean\;of\;group\;A, \beta_{1} = Mean\;of\;group\;B$$`


&lt;table style="cellspacing:0; cellpadding:0; border:none; padding-top:25px" width=100%&gt;
  &lt;col width="50%"&gt;
  &lt;col width="50%"&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Group&lt;/b&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;x&lt;/b&gt;
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Group = A
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    x = 0
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Group = B
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    x = 1
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;/table&gt;
]


.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;


]



---

# t-test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Does the mean of group A differ from group B?&lt;/b&gt;&lt;/font&gt;

Conduct a &lt;high&gt;t-test&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;2 levels&lt;/high&gt; A and B

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

`$$\Large t = \frac{\bar{x}_{A}-\bar{x}_{B}}{\sqrt{s^{2}(\frac{1}{n_{A}}+\frac{1}{n_{B}})}}$$`
`$$\Large s^{2} = Pooled\;variance$$`

&lt;br&gt;

*Pooled variance means "Average Variance"* 

]

.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;

]



---

# t-test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Does the mean of group A differ from group B?&lt;/b&gt;&lt;/font&gt;

Conduct a &lt;high&gt;t-test&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;2 levels&lt;/high&gt; A and B

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

`$$\Large t = \frac{\bar{x}_{A}-\bar{x}_{B}}{\sqrt{s^{2}(\frac{1}{n_{A}}+\frac{1}{n_{B}})}}$$`
`$$\Large s^{2} = Pooled\;variance$$`

&lt;br&gt;

*Pooled variance means "Average Variance"* 

]

.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]



---

# t-test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Does the mean of group A differ from group B?&lt;/b&gt;&lt;/font&gt;

Conduct a &lt;high&gt;t-test&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;2 levels&lt;/high&gt; A and B

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

`$$\Large t = \frac{\bar{x}_{A}-\bar{x}_{B}}{\sqrt{s^{2}(\frac{1}{n_{A}}+\frac{1}{n_{B}})}}$$`
`$$\Large s^{2} = Pooled\;variance$$`

&lt;br&gt;

*Pooled variance means "Average Variance"* 

]

.pull-right45[


```r
# 2-sample t-test
inc_ht &lt;- t.test(formula = income ~ sex,
                 data = baselers)

# Print
inc_ht
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  income by sex
## t = 4, df = 8500, p-value = 6e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  120.6 352.2
## sample estimates:
## mean in group female   mean in group male 
##                 7650                 7414
```

]



---

# t-test

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Does the mean of group A differ from group B?&lt;/b&gt;&lt;/font&gt;

Conduct a &lt;high&gt;t-test&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;2 levels&lt;/high&gt; A and B

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

`$$\Large t = \frac{\bar{x}_{A}-\bar{x}_{B}}{\sqrt{s^{2}(\frac{1}{n_{A}}+\frac{1}{n_{B}})}}$$`
`$$\Large s^{2} = Pooled\;variance$$`

&lt;br&gt;

*Pooled variance means "Average Variance"* 

]
.pull-right45[


```r
# Show all named elements
names(inc_ht)
```

```
## [1] "statistic"   "parameter"  
## [3] "p.value"     "conf.int"   
## [5] "estimate"    "null.value" 
## [7] "alternative" "method"     
## [9] "data.name"
```

```r
# Print the test statistic
inc_ht$statistic
```

```
##     t 
## 4.001
```

```r
# Print the p.value
inc_ht$p.value
```

```
## [1] 6.366e-05
```

]




---

# ANOVA

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Do the means of my (many) groups differ?&lt;/b&gt;&lt;/font&gt;

Conduct an &lt;high&gt;ANOVA&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;more than 2 levels&lt;/high&gt; A, B, C, ...

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

&lt;br&gt;

`$$\Large F = \frac{Variance\;Between\;Groups}{Variance\;Within\;Groups}$$`

&lt;br&gt;

*Is the variability between my groups large relative to the variability within each group?*

]

.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;

]


---

.pull-left45[

# ANOVA

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Do the means of my (many) groups differ?&lt;/b&gt;&lt;/font&gt;

Conduct an &lt;high&gt;ANOVA&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;more than 2 levels&lt;/high&gt; A, B, C, ...

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

&lt;br&gt;

`$$\Large F = \frac{Variance\;Between\;Groups}{Variance\;Within\;Groups}$$`

&lt;br&gt;

*Is the variability between my groups large relative to the variability within each group?*

]

.pull-right5[

&lt;br&gt;&lt;br&gt;&lt;br&gt;

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-17-1.png" width="80%" style="display: block; margin: auto;" /&gt;

]



---

# ANOVA with `aov()`

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Do the means of my (many) groups differ?&lt;/b&gt;&lt;/font&gt;

Conduct an &lt;high&gt;ANOVA&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;more than 2 levels&lt;/high&gt; A, B, C, ...

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

&lt;br&gt;

`$$\Large F = \frac{Variance\;Between\;Groups}{Variance\;Within\;Groups}$$`

&lt;br&gt;

*Is the variability between my groups large relative to the variability within each group?*

]

.pull-right45[

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]



---

# ANOVA with `aov()`

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Do the means of my (many) groups differ?&lt;/b&gt;&lt;/font&gt;

Conduct an &lt;high&gt;ANOVA&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;more than 2 levels&lt;/high&gt; A, B, C, ...

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

&lt;br&gt;

`$$\Large F = \frac{Variance\;Between\;Groups}{Variance\;Within\;Groups}$$`

&lt;br&gt;

*Is the variability between my groups large relative to the variability within each group?*

]

.pull-right45[


```r
# Relationship height and education?
height_ht &lt;- 
  aov(formula = height ~ education,
                data = baselers)

# Print result
height_ht
```

```
## Call:
##    aov(formula = height ~ education, data = baselers)
## 
## Terms:
##                 education Residuals
## Sum of Squares      12440   1582357
## Deg. of Freedom         3      9996
## 
## Residual standard error: 12.58
## Estimated effects may be unbalanced
```

]




---

# ANOVA with `aov()`

.pull-left45[

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Do the means of my (many) groups differ?&lt;/b&gt;&lt;/font&gt;

Conduct an &lt;high&gt;ANOVA&lt;/high&gt; when you have one nominal independent variable with &lt;high&gt;more than 2 levels&lt;/high&gt; A, B, C, ...

&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

&lt;br&gt;

`$$\Large F = \frac{Variance\;Between\;Groups}{Variance\;Within\;Groups}$$`

&lt;br&gt;

*Is the variability between my groups large relative to the variability within each group?*

]

.pull-right45[
  


```r
# Show summary results
summary(height_ht)
```

```
##               Df  Sum Sq Mean Sq F value
## education      3   12440    4147    26.2
## Residuals   9996 1582357     158        
##             Pr(&gt;F)    
## education   &lt;2e-16 ***
## Residuals             
## ---
## Signif. codes:  
##   0 '***' 0.001 '**' 0.01 '*' 0.05 '.'
##   0.1 ' ' 1
```

]


---

.pull-left35[

# ANOVA post-hoc with `TukeyHSD()`

&lt;br2&gt;

&lt;font style="font-size:22px"&gt;&lt;b&gt;Which groups differ?&lt;/b&gt;&lt;/font&gt;

After conducting an &lt;high&gt;ANOVA&lt;/high&gt;, conduct a &lt;high&gt;post-hoc test&lt;/high&gt; to see which specific pairs of groups differ
.
&lt;font style="font-size:22px"&gt;&lt;b&gt;Formula&lt;/b&gt;&lt;/font&gt;

&lt;br&gt;

`$$\Large t = \frac{\bar{x}_{A}-\bar{x}_{B}}{Total\;Variability}$$`

]

.pull-right55[

&lt;br&gt;



```r
# Conduct post-hoc tests
#   Which pairs of groups differ?

TukeyHSD(height_ht)
```


```
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = height ~ education, data = baselers)
## 
## $education
##                    diff     lwr    upr
## High School-BA   0.2708 -0.7808 1.3223
## MS-BA           -0.7759 -2.2772 0.7254
## PhD-BA           2.2936  1.2435 3.3436
## MS-High School  -1.0467 -2.3400 0.2466
## PhD-High School  2.0228  1.3008 2.7448
## PhD-MS           3.0695  1.7774 4.3616
##                  p adj
## High School-BA  0.9115
## MS-BA           0.5451
## PhD-BA          0.0000
## MS-High School  0.1599
## PhD-High School 0.0000
## PhD-MS          0.0000
```

]






---

# `tidy()`

.pull-left4[

The `tidy()` function from the `broom` package &lt;high&gt;converts&lt;/high&gt; the most important results of many statistical objects to a &lt;high&gt;data frame&lt;/high&gt;.

Try `tidy()` on your favorite statistical object and see what you get!

&lt;p align = "center"&gt;
  &lt;img src="image/broom_hex.png" style="padding-bottom:25px" height=200px&gt;
&lt;/p&gt;


]

.pull-right55[


```r
# Load broom package
library(broom)   # For tidy()

# Conduct correlation test
income_htest &lt;- cor.test(formula = ~ height + income,
                         data = baselers)

# Standard printout
income_htest
```

```
## 
## 	Pearson's product-moment correlation
## 
## data:  height and income
## t = -2.5, df = 8500, p-value = 0.01
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.048577 -0.006115
## sample estimates:
##      cor 
## -0.02736
```

]


---

# `tidy()`

.pull-left4[

The `tidy()` function from the `broom` package &lt;high&gt;converts&lt;/high&gt; the most important results of many statistical objects to a &lt;high&gt;data frame&lt;/high&gt;.

Try `tidy()` on your favorite statistical object and see what you get!

&lt;p align = "center"&gt;
  &lt;img src="image/broom_hex.png" style="padding-bottom:25px" height=200px&gt;
&lt;/p&gt;

]

.pull-right55[


```r
# Load broom package
library(broom)   # For tidy()

# Conduct correlation test
income_htest &lt;- cor.test(formula = ~ height + income,
                         data = baselers)

tidy(income_htest)
```

```
## # A tibble: 1 x 8
##   estimate statistic p.value parameter
##      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;
## 1  -0.0274     -2.52  0.0116      8508
## # … with 4 more variables: conf.low &lt;dbl&gt;,
## #   conf.high &lt;dbl&gt;, method &lt;chr&gt;,
## #   alternative &lt;chr&gt;
```

]

---

# `tidy()`

.pull-left4[

The `tidy()` function from the `broom` package &lt;high&gt;converts&lt;/high&gt; the most important results of many statistical objects to a &lt;high&gt;data frame&lt;/high&gt;.

Try `tidy()` on your favorite statistical object and see what you get!

&lt;p align = "center"&gt;
  &lt;img src="image/broom_hex.png" style="padding-bottom:25px" height=200px&gt;
&lt;/p&gt;


]

.pull-right55[


```r
# Load broom package
library(broom)   # For tidy()

# Conduct t.test
height_sex_ttest &lt;- t.test(formula = height ~ sex,
                           data = baselers)
height_sex_ttest
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  height by sex
## t = -67, df = 9900, p-value &lt;2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -14.41 -13.59
## sample estimates:
## mean in group female   mean in group male 
##                  164                  178
```

]


---

# `tidy()`

.pull-left4[

The `tidy()` function from the `broom` package &lt;high&gt;converts&lt;/high&gt; the most important results of many statistical objects to a &lt;high&gt;data frame&lt;/high&gt;.

Try `tidy()` on your favorite statistical object and see what you get!

&lt;p align = "center"&gt;
  &lt;img src="image/broom_hex.png" style="padding-bottom:25px" height=200px&gt;
&lt;/p&gt;


]

.pull-right55[


```r
# Load broom package
library(broom)   # For tidy()

# Conduct t.test
height_sex_ttest &lt;- t.test(formula = height ~ sex,
                           data = baselers)

# tidy results
tidy(height_sex_ttest)
```

```
## # A tibble: 1 x 10
##   estimate estimate1 estimate2 statistic
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1    -14.0      164.      178.     -66.6
## # … with 6 more variables: p.value &lt;dbl&gt;,
## #   parameter &lt;dbl&gt;, conf.low &lt;dbl&gt;,
## #   conf.high &lt;dbl&gt;, method &lt;chr&gt;,
## #   alternative &lt;chr&gt;
```

]


---

.pull-left45[

# Distribution functions

R has a several functions that allow you to draw &lt;high&gt;random samples&lt;/high&gt; data from specified distributions:


&lt;table style="cellspacing:0; cellpadding:0; border:none; padding-top:10px" width=100%&gt;
  &lt;col width="25%"&gt;
  &lt;col width="25%"&gt;
  &lt;col width="25%"&gt;
  &lt;col width="25%"&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Type&lt;/b&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;CDF&lt;/b&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;CDF&lt;sup&gt;-1&lt;/sup&gt;&lt;/b&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;b&gt;Simulate&lt;/b&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Normal
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;pnorm()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qnorm()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;rnorm()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Uniform
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;punif()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qunif()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;runif()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    F
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;pf()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qf()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;rf()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Binomial
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;pbinom()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qbinom()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;rbinom()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Chi-square
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;pchisq()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qchisq()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;rchisq()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;/table&gt;

&lt;br&gt;

&lt;high&gt;CDF&lt;/high&gt; - Cumulative Density Function&lt;br&gt;&lt;high&gt;CDF&lt;sup&gt;-1&lt;/sup&gt;&lt;/high&gt; - Inverse Cumulative Density Function
]

.pull-right45[

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;


```r
# Pr(z ≤ 2)
pnorm(2, mean = 0, sd = 1)
```

```
## [1] 0.9772
```

```r
# z for p(z ≤ x) = 68%
qnorm(.68, mean = 0, sd = 1)
```

```
## [1] 0.4677
```

```r
# simulate z
rnorm(23, mean = 0, sd = 1)
```

```
##  [1] -0.27253 -0.36898  0.35302  0.87006
##  [5] -0.09277  0.45343 -0.21054 -1.96924
##  [9] -0.61462 -0.33692  2.13845  0.32882
## [13] -1.05609  0.10568  0.26327  0.31299
## [17]  0.43195 -0.50643 -1.21301  0.36599
## [21]  0.11673 -1.35680 -2.07270
```


]

---

.pull-left45[

# Distribution functions

R has a several functions that allow you to draw &lt;high&gt;random samples&lt;/high&gt; data from specified distributions:


&lt;table style="cellspacing:0; cellpadding:0; border:none; padding-top:10px" width=100%&gt;
  &lt;col width="25%"&gt;
  &lt;col width="25%"&gt;
  &lt;col width="25%"&gt;
  &lt;col width="25%"&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Type&lt;/b&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;CDF&lt;/b&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;CDF&lt;sup&gt;-1&lt;/sup&gt;&lt;/b&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;b&gt;Simulate&lt;/b&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Normal
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;pnorm()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qnorm()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;rnorm()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Uniform
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;punif()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qunif()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;runif()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    F
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;pf()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qf()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;rf()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Binomial
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;pbinom()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qbinom()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;rbinom()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Chi-square
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;pchisq()&lt;/mono&gt;
  &lt;/td&gt; 
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;qchisq()&lt;/mono&gt;
  &lt;/td&gt; 
    &lt;td bgcolor="white"&gt;
    &lt;mono&gt;rchisq()&lt;/mono&gt;
  &lt;/td&gt; 
&lt;/tr&gt;
&lt;/table&gt;

&lt;br&gt;

&lt;high&gt;CDF&lt;/high&gt; - Cumulative Density Function&lt;br&gt;&lt;high&gt;CDF&lt;sup&gt;-1&lt;/sup&gt;&lt;/high&gt; - Inverse Cumulative Density Function
]

.pull-right45[

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;


```r
# Pr(t ≤ 2)
pt(2, df = 99)
```

```
## [1] 0.9759
```

```r
# z for p(z ≤ x) = 68%
qt(.68, df = 99)
```

```
## [1] 0.4691
```

```r
# simulate z
rt(23, df = 99)
```

```
##  [1] -0.61673  0.08941  0.49011  1.33736
##  [5] -0.61308  0.74276  0.77337 -1.15292
##  [9]  0.67891  0.98415 -1.16118  1.24822
## [13]  0.98867 -1.09769 -0.46602 -0.52857
## [17] -0.96983  1.32325  0.34523  1.03262
## [21] -0.13193 -2.37821 -0.15682
```

]


---

class: middle, center

&lt;h1&gt;&lt;a href="https://therbootcamp.github.io/SwR_2019Apr/_sessions/LinearModelsII/LinearModelsII_practical.html"&gt;Practical&lt;/a&gt;&lt;/h1&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
