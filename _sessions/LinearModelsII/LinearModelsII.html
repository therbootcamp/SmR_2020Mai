<!DOCTYPE html>
<html>
  <head>
    <title>Linear Models II</title>
    <meta charset="utf-8">
    <meta name="author" content="Statistics with R   Basel R Bootcamp" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="baselrbootcamp.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Linear Models II</i>
### Statistics with R<br> <a href='https://therbootcamp.github.io'> Basel R Bootcamp </a> <br> <a href='https://therbootcamp.github.io/SwR_2019Apr/'> <i class='fas fa-clock' style='font-size:.9em;'></i> </a>  <a href='https://therbootcamp.github.io'> <i class='fas fa-home' style='font-size:.9em;' ></i> </a>  <a href='mailto:therbootcamp@gmail.com'> <i class='fas fa-envelope' style='font-size: .9em;'></i> </a>  <a href='https://www.linkedin.com/company/basel-r-bootcamp/'> <i class='fab fa-linkedin' style='font-size: .9em;'></i> </a>
### April 2019

---


layout: true

&lt;div class="my-footer"&gt;
  &lt;span style="text-align:center"&gt;
    &lt;span&gt; 
      &lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png" height=14 style="vertical-align: middle"/&gt;
    &lt;/span&gt;
    &lt;a href="https://therbootcamp.github.io/"&gt;
      &lt;span style="padding-left:82px"&gt; 
        &lt;font color="#7E7E7E"&gt;
          www.therbootcamp.com
        &lt;/font&gt;
      &lt;/span&gt;
    &lt;/a&gt;
    &lt;a href="https://therbootcamp.github.io/"&gt;
      &lt;font color="#7E7E7E"&gt;
       Statistics with R | April 2019
      &lt;/font&gt;
    &lt;/a&gt;
    &lt;/span&gt;
  &lt;/div&gt; 

---





.pull-left45[

# Linear Model Applications

In the last session, we saw that a linear model is one that can be written in the following form &lt;br&gt;

*Linear Model Equation*

`$$\huge Y = \beta_{0} + \beta_{1}x_{1} + \beta_{2} x_{2} +  ... + \beta_{n}x_{n} + \epsilon$$`

What you may not realise, is that many of your favorite tests, including &lt;high&gt;t-tests&lt;/high&gt;, &lt;high&gt;correlation tests&lt;/high&gt;, and &lt;high&gt;ANOVAs&lt;/high&gt; can all be expressed as linear models! 

This means that you can use the `glm()` function to do all of these tests!

However, R also has special hypothesis test functions that allow you to do them as well.


]

.pull-right55[

]

---

# Hypothesis testing

- We will now cover all of your favorite hypothesis tests in R.

- Don't worry, we'll show you that they are all special cases of the linear model!

---

# Correlation test

Null Hypothesis
Alternative

---
# T tests

Null Hypothesis

Alternative

---
# ANOVA

Null hypothesis

Alternative

Post-hoc-tests

---

# Extensions to the linear model

What is your dependent variable is not normally distributed?

Binary; Logistic regression

Skewed: Log the data!


---

# A note: Correlation is not causation!

- Correlation versus causation
    - Classic fails:
        - Ice cream and forest fires.
        - Chocolate and IQ
    - Inferring causation requires an experiment and/or causal modelling


---
class: middle, center

# R
## How to conduct and understand hypothesis tests

---

- t.test()
- cor.test()
- aov()
    - TukeyHSD()
- broom::tidy()



---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
&lt;br&gt;
*Do male and female baselers have different mean incomes?*

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-2-1.png" width="90%" /&gt;

]

---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|


]

.pull-right6[
&lt;br&gt;
### t-test with `t.test()`


```r
# 2-sample t-test
income_htest &lt;- t.test(formula = income ~ sex,
                       data = baselers)

# Print
income_htest
```

```
## 
## 	Welch Two Sample t-test
## 
## data:  income by sex
## t = 4, df = 8500, p-value = 6e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  120.6 352.2
## sample estimates:
## mean in group female   mean in group male 
##                 7650                 7414
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
&lt;br&gt;
### t-test with `t.test()`


```r
# Show all named elements
names(income_htest)
```

```
## [1] "statistic"   "parameter"   "p.value"     "conf.int"    "estimate"    "null.value"  "alternative"
## [8] "method"      "data.name"
```

```r
# Print the test statistic
income_htest$statistic
```

```
##     t 
## 4.001
```

```r
# Print the p.value
income_htest$p.value
```

```
## [1] 6.366e-05
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|


]


.pull-right6[
&lt;br&gt;
*Do older baselers have higher incomes than younger baselers?*

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-5-1.png" width="90%" /&gt;

]

---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|


]


.pull-right6[
&lt;br&gt;
### Correlation test with `cor.test()`


```r
# Is there a relationship between age and income?

income_htest &lt;- cor.test(formula = ~ age + income,
                         data = baselers)

# Print result
income_htest
```

```
## 
## 	Pearson's product-moment correlation
## 
## data:  age and income
## t = 180, df = 8500, p-value &lt;2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.8882 0.8968
## sample estimates:
##    cor 
## 0.8926
```

]


---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|


]


.pull-right6[
&lt;br&gt;
### Correlation test with `cor.test()`


```r
# Show all named elements
names(income_htest)
```

```
## [1] "statistic"   "parameter"   "p.value"     "estimate"    "null.value"  "alternative" "method"     
## [8] "data.name"   "conf.int"
```

```r
# Show estimated correlation coefficient
income_htest$estimate
```

```
##    cor 
## 0.8926
```

```r
# Show p-value
income_htest$p.value
```

```
## [1] 0
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
&lt;br&gt;
### ANOVA with `aov()`

&lt;img src="LinearModelsII_files/figure-html/unnamed-chunk-8-1.png" width="90%" /&gt;

]

---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
&lt;br&gt;
### ANOVA with `aov()`


```r
# Is there a relationship btwn education and height?

height_htest &lt;- aov(formula = height ~ education,
                    data = baselers)

# Print result
height_htest
```

```
## Call:
##    aov(formula = height ~ education, data = baselers)
## 
## Terms:
##                 education Residuals
## Sum of Squares      12440   1582357
## Deg. of Freedom         3      9996
## 
## Residual standard error: 12.58
## Estimated effects may be unbalanced
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
&lt;br&gt;
### ANOVA with `aov()`


```r
# Show summary results
summary(height_htest)
```

```
##               Df  Sum Sq Mean Sq F value Pr(&gt;F)    
## education      3   12440    4147    26.2 &lt;2e-16 ***
## Residuals   9996 1582357     158                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic &lt;high&gt;one and two sample hypothesis tests&lt;/high&gt; are included in the `stats` package.

These tests take either a &lt;high&gt;formula&lt;/high&gt; for the argument `formula`, or &lt;high&gt;individual vectors&lt;/high&gt; for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
&lt;br&gt;
### ANOVA with `aov()`


```r
# post-hoc tests
TukeyHSD(height_htest)
```

```
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = height ~ education, data = baselers)
## 
## $education
##                                     diff    lwr    upr  p adj
## obligatory_school-apprenticeship -0.2708 -1.322 0.7808 0.9115
## SEK_II-apprenticeship            -1.0467 -2.340 0.2466 0.1599
## SEK_III-apprenticeship            2.0228  1.301 2.7448 0.0000
## SEK_II-obligatory_school         -0.7759 -2.277 0.7254 0.5451
## SEK_III-obligatory_school         2.2936  1.244 3.3436 0.0000
## SEK_III-SEK_II                    3.0695  1.777 4.3616 0.0000
```

]

---

.pull-left35[
# Simulation functions

R has a several functions that allow you to draw &lt;high&gt;random samples&lt;/high&gt; data from specified distributions:

|Type|Function|
|:----|:------|
|Normal|`rnorm(n, mean, sd)`|
|Uniform|`runif(n, min, max)`|
|Binomial|`rbinom(n, size, prob)`|
|Sample|`sample(x)`|

These allow you to run your own &lt;high&gt;simulations&lt;/high&gt;!

]

.pull-right6[

*Drawing Random Samples*


```r
# 5 samples from N(mean = 100, sd = 10)
noisy &lt;- rnorm(n = 5, mean = 100, sd = 10)

noisy
```

```
## [1]  98.22  86.13  82.91  82.46 107.63
```

```r
mean(noisy)
```

```
## [1] 91.47
```

```r
sd(noisy)
```

```
## [1] 11.06
```

```r
# Simulate 10 coin flilps
coin_flips &lt;- rbinom(n = 10, size = 1, prob = .5)

coin_flips
```

```
##  [1] 1 1 0 1 0 0 1 0 1 1
```



]



---

class: middle, center

&lt;h1&gt;&lt;a href="https://therbootcamp.github.io/SwR_2019Apr/_sessions/RegressionI/RegressionI_practical.html"&gt;Practical&lt;/a&gt;&lt;/h1&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
