---
title: "Linear Models II</i>"
subittle: "Applications"
author: "Statistics with R<br>
  <a href='https://therbootcamp.github.io'>
    Basel R Bootcamp
  </a>
  <br>
  <a href='https://therbootcamp.github.io/SwR_2019Apr/'>
    <i class='fas fa-clock' style='font-size:.9em;'></i>
  </a>&#8239; 
  <a href='https://therbootcamp.github.io'>
    <i class='fas fa-home' style='font-size:.9em;' ></i>
  </a>&#8239;
  <a href='mailto:therbootcamp@gmail.com'>
    <i class='fas fa-envelope' style='font-size: .9em;'></i>
  </a>&#8239;
  <a href='https://www.linkedin.com/company/basel-r-bootcamp/'>
    <i class='fab fa-linkedin' style='font-size: .9em;'></i>
  </a>"
date: "April 2019"
output:
  xaringan::moon_reader:
    css: ["default", "baselrbootcamp.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'
---

layout: true

<div class="my-footer">
  <span style="text-align:center">
    <span> 
      <img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png" height=14 style="vertical-align: middle"/>
    </span>
    <a href="https://therbootcamp.github.io/">
      <span style="padding-left:82px"> 
        <font color="#7E7E7E">
          www.therbootcamp.com
        </font>
      </span>
    </a>
    <a href="https://therbootcamp.github.io/">
      <font color="#7E7E7E">
       Statistics with R | April 2019
      </font>
    </a>
    </span>
  </div> 

---

```{r, eval = TRUE, echo = FALSE, warning=F,message=F}
# Code to knit slides

```

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
# see: https://github.com/yihui/xaringan
# install.packages("xaringan")
# see: 
# https://github.com/yihui/xaringan/wiki
# https://github.com/gnab/remark/wiki/Markdown
options(width = 110)
options(digits = 4)

# Load packages
require(tidyverse)


# Load data
baselers <- readr::read_csv("1_Data/baselers.csv")

```

.pull-left45[

# Linear Model Applications

In the last session, we saw that a linear model is one that can be written in the following form <br>

*Linear Model Equation*

$$\huge Y = \beta_{0} + \beta_{1}x_{1} + \beta_{2} x_{2} +  ... + \beta_{n}x_{n} + \epsilon$$

What you may not realise, is that many of your favorite tests, including <high>t-tests</high>, <high>correlation tests</high>, and <high>ANOVAs</high> can all be expressed as linear models! 

This means that you can use the `glm()` function to do all of these tests!

However, R also has special hypothesis test functions that allow you to do them as well.


]

.pull-right55[

]

---

# Hypothesis testing

- We will now cover all of your favorite hypothesis tests in R.

- Don't worry, we'll show you that they are all special cases of the linear model!

---

# Correlation test

Null Hypothesis
Alternative

---
# T tests

Null Hypothesis

Alternative

---
# ANOVA

Null hypothesis

Alternative

Post-hoc-tests

---

# Extensions to the linear model

What is your dependent variable is not normally distributed?

Binary; Logistic regression

Skewed: Log the data!


---

# A note: Correlation is not causation!

- Correlation versus causation
    - Classic fails:
        - Ice cream and forest fires.
        - Chocolate and IQ
    - Inferring causation requires an experiment and/or causal modelling


---
class: middle, center

# R
## How to conduct and understand hypothesis tests

---

- t.test()
- cor.test()
- aov()
    - TukeyHSD()
- broom::tidy()



---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
<br>
*Do male and female baselers have different mean incomes?*

```{r, echo  = FALSE, warning = FALSE, fig.width = 4, fig.height = 4, dpi = 300, out.width = "90%"}
ggplot(baselers, aes(x = sex, y = income)) +
   geom_boxplot() +
  geom_jitter(alpha = .01, width = .1) +
  labs(title = "Income of female and male baselers",
       caption = "Fake data :)")
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|


]

.pull-right6[
<br>
### t-test with `t.test()`

```{r}
# 2-sample t-test
income_htest <- t.test(formula = income ~ sex,
                       data = baselers)

# Print
income_htest
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
<br>
### t-test with `t.test()`

```{r}
# Show all named elements
names(income_htest)

# Print the test statistic
income_htest$statistic

# Print the p.value
income_htest$p.value
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|


]


.pull-right6[
<br>
*Do older baselers have higher incomes than younger baselers?*

```{r, echo  = FALSE, warning = FALSE, fig.width = 4, fig.height = 4, dpi = 300, out.width = "90%"}
ggplot(baselers, aes(x = age, y = income)) +
  geom_point(alpha = .03) +
  labs(title = "Age and Income of Baselers",
       caption = "Fake data :)")
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|


]


.pull-right6[
<br>
### Correlation test with `cor.test()`

```{r}
# Is there a relationship between age and income?

income_htest <- cor.test(formula = ~ age + income,
                         data = baselers)

# Print result
income_htest
```

]


---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|


]


.pull-right6[
<br>
### Correlation test with `cor.test()`

```{r}
# Show all named elements
names(income_htest)

# Show estimated correlation coefficient
income_htest$estimate

# Show p-value
income_htest$p.value
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
<br>
### ANOVA with `aov()`

```{r, echo  = FALSE, warning = FALSE, fig.width = 6, fig.height = 4, dpi = 300, out.width = "90%"}
ggplot(baselers, aes(x = education, y = height)) +
   geom_boxplot() +
  geom_jitter(alpha = .01, width = .1) +
  labs(title = "Baseler height based on education",
       caption = "Fake data :)")
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
<br>
### ANOVA with `aov()`

```{r}
# Is there a relationship btwn education and height?

height_htest <- aov(formula = height ~ education,
                    data = baselers)

# Print result
height_htest
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
<br>
### ANOVA with `aov()`

```{r}
# Show summary results
summary(height_htest)
```

]

---

.pull-left35[

# Hypothesis tests

All of the basic <high>one and two sample hypothesis tests</high> are included in the `stats` package.

These tests take either a <high>formula</high> for the argument `formula`, or <high>individual vectors</high> for the arguments `x`, and `y`

| Hypothesis Test| R Function|
|:------------|:------------|
|     t-test|    `t.test()`|
|     Correlation Test|    `cor.test()`|
|     ANOVA|   `aov()`|
|Post-hoc tests| `TukeyHSD()`|

]

.pull-right6[
<br>
### ANOVA with `aov()`

```{r}
# post-hoc tests
TukeyHSD(height_htest)
```

]

---

.pull-left35[
# Simulation functions

R has a several functions that allow you to draw <high>random samples</high> data from specified distributions:

|Type|Function|
|:----|:------|
|Normal|`rnorm(n, mean, sd)`|
|Uniform|`runif(n, min, max)`|
|Binomial|`rbinom(n, size, prob)`|
|Sample|`sample(x)`|

These allow you to run your own <high>simulations</high>!

]

.pull-right6[

*Drawing Random Samples*

```{r}
# 5 samples from N(mean = 100, sd = 10)
noisy <- rnorm(n = 5, mean = 100, sd = 10)

noisy

mean(noisy)

sd(noisy)

# Simulate 10 coin flilps
coin_flips <- rbinom(n = 10, size = 1, prob = .5)

coin_flips

```



]



---

class: middle, center

<h1><a href="https://therbootcamp.github.io/SwR_2019Apr/_sessions/RegressionI/RegressionI_practical.html">Practical</a></h1>

