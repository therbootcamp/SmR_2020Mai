<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Mixed Models</title>

<script src="MixedModels_practical_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="MixedModels_practical_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="MixedModels_practical_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="MixedModels_practical_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="MixedModels_practical_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="MixedModels_practical_files/navigation-1.1/tabsets.js"></script>
<link href="MixedModels_practical_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="MixedModels_practical_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="practical.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Mixed Models</h1>
<h4 class="author"><em><table style='table-layout:fixed;width:100%;border:0;padding:0;margin:0'>
<col width='10%'>
<col width='10%'>
<tr style="border:none">
<td style="display:block;width:100%;text-align:left;vertical-align:bottom;padding:0;margin:0;border:none" nowrap>
<font style='font-style:normal'>Statistics with R</font><br> <a href='https://therbootcamp.github.io/SWR_2019Apr/'> <i class='fas fa-clock' style='font-size:.9em;' ></i> </a> <a href='https://therbootcamp.github.io'> <i class='fas fa-home' style='font-size:.9em;'></i> </a> <a href='mailto:therbootcamp@gmail.com'> <i class='fas fa-envelope' style='font-size: .9em;'></i> </a> <a href='https://www.linkedin.com/company/basel-r-bootcamp/'> <i class='fab fa-linkedin' style='font-size: .9em;'></i> </a> <a href='https://therbootcamp.github.io'> <font style='font-style:normal'>Basel R Bootcamp</font> </a>
</td>
<td style="width:100%;vertical-align:bottom;text-align:right;padding:0;margin:0;border:none">
<img src='https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png' style='height:15px;width:80px'/>
</td>
</tr>
</table></em></h4>

</div>


<p align="center" width="100%">
<img src="image/placeholder.png" alt="Trulli" style="width:100%;height:280px"> <br> <font style="font-size:10px">from <a href="">shorted URL</a></font>
</p>
<div id="section" class="section level1 tabset">
<h1></h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>In this practical you’ll practice “XXX” with the <code>XXX</code> packages.</p>
<p>By the end of this practical you will know how to:</p>
<ol style="list-style-type: decimal">
<li>Run mixed effects models in R.</li>
<li>Extract p-values for fixed and random effects.</li>
<li>Specify crossed vs. nested random effects and what implications this has.</li>
<li>Extract variance components and compute the intra-class correlation</li>
<li>Visualize your linear mixed effects model.</li>
<li>Run a generalized mixed effects model.</li>
</ol>
</div>
<div id="tasks" class="section level2">
<h2>Tasks</h2>
<div id="a---setup" class="section level3">
<h3>A - Setup</h3>
<p>Datasets: - psych: sai - lme4: penicillin - blogposts/ rstanarm/ arm: schools example</p>
<ol style="list-style-type: decimal">
<li><p>Open your <code>BaselRBootcamp</code> R project. It should already have the folders <code>1_Data</code> and <code>2_Code</code>. Make sure that the data files listed in the <code>Datasets</code> section above are in your <code>1_Data</code> folder</p></li>
<li><p>Open a new R script. At the top of the script, using comments, write your name and the date. Save it as a new file called <code>MixedModels_practical.R</code> in the <code>2_Code</code> folder.</p></li>
<li><p>Using <code>library()</code> load the <code>tidyverse</code>, <code>lme4</code>, and <code>sjstats</code> packages (if you don’t have them, you’ll need to install them with <code>install.packages()</code>)!</p></li>
</ol>
<pre class="r"><code># Load packages necessary for this script
library(tidyverse)
library(lme4)
library(sjstats)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Using the following template, load the <code>Tomatometer_dat.csv</code> data into R and store it as a new object called <code>tom_df</code> (Hint: Don’t type the path directly! Use the “tab” completion!).</li>
</ol>
<pre class="r"><code># Load Tomatometer_dat.csv from the 1_Data folder

XX &lt;- read_csv(file = &quot;XX/XX&quot;)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Take a look at the first few rows of the datasets by printing them to the console.</li>
</ol>
<pre class="r"><code># Print the tom_df object
XXX</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Use the the <code>summary()</code> function to print more details on the columns of the datasets.</li>
</ol>
<pre class="r"><code>summary(XXX)</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Use the <code>View()</code> function to view the entire dataframe in a new window.</li>
</ol>
<pre class="r"><code>View(XXX)</code></pre>
</div>
<div id="b---running-a-linear-mixed-effects-model" class="section level3">
<h3>B - Running a Linear Mixed Effects Model</h3>
<p>In the first part of this practical we will work with the data example from the slides and test the effect of a person’s <code>State</code> (“Sober” vs. “Drunk”) on his or her <code>Tomatometer</code> rating.</p>
<ol style="list-style-type: decimal">
<li>Run fixed effects only model predicting <code>Tomatometer</code> with <code>State</code> and save the result as <code>FE_mod</code>. Then inspect the results.</li>
</ol>
<pre class="r"><code># Use lm, as lmer only works if at least one random effect is specified
FE_mod &lt;- glm(XXX ~ XXX, data = XXX)

# Inspect the resuts
summary(FE_mod)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>In your model, it took “Drunk” as base state, so the regression coefficient you obtained shows how much lower the ratings in <code>State == &quot;Sober&quot;</code> are. It may be more intuitive to have “Sober” as the base level. To do this we have to coerce the <code>State</code> variable into a factor and set the levels. Do this by running the following code.</li>
</ol>
<pre class="r"><code># Coerce the State variable into a factor
tom_df &lt;- tom_df %&gt;%
  mutate(State = factor(State, levels = c(&quot;Sober&quot;, &quot;Drunk&quot;)))</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Now rerun your model from task B1 (the only thing that should change is that your coefficient is now called <code>StateDrunk</code> and now has a positive sign, and that your Intercept now shows the mean of the Sober condition).</p></li>
<li><p>In the talk, you have learned that if we have repeated measures, the indepence assumption is violated. We can account for this by running a mixed effects model. Run a model with by-subjects random intercepts (subjects identifiers are stored in the <code>ID</code> variable). <em>Hint</em>: Random effects are specified in parenthesis in the formula in the following way <code>(</code><a href="https://en.wikipedia.org/wiki/Design_matrix">design_matrix</a><code>|grouping_variable)</code>. <strong>Note</strong>: Do you see the <code>REML = FALSE</code> in the model specification? It tells R to fit the model using maximum likelihood (ML), rather than restricted maximul likelihood (REML; for more information on this in a technical approach see <a href="https://projecteuclid.org/euclid.cbms/1462106081">here</a> and <a href="http://www.stats.net.au/Maths_REML_manual.pdf">here</a>, for a less technical approach see <a href="https://en.wikipedia.org/wiki/Restricted_maximum_likelihood">here</a>). This will later be important for certain model comparisons that only work if the model was fitted using ML.</p></li>
</ol>
<pre class="r"><code># Mixed effects model with by-subject random intercepts
subj_RI_mod &lt;- lmer(XXX ~ XXX +           # These are the fixed effects
                    (1|XXX),              # These are the random effects
                    data = XXX,           # Specify the data used
                    REML = FALSE)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><p>Using <code>summary()</code>, inspect the results of the mixed effects model. Did the effect of <code>State</code> change, now that you incorporated the random effects? Can you find out what did change from the model outputs? (Did you note that there were no p-values in the output? We will look into that later in this practical)</p></li>
<li><p>Sometimes when we want to make plots or tables, it is usefull if we can extract the estimates from the model output so we don’t have to manually type them (which is error prone). The <code>lme4</code> package provides functions for this. Extract the fixed effects of your model using the <code>fixef()</code> function.</p></li>
</ol>
<pre class="r"><code>fixef(XXX)</code></pre>
<ol start="7" style="list-style-type: decimal">
<li><p>Now extract the random effects using the <code>ranef()</code> function.</p></li>
<li><p>Now expand your mixed effects model from task B4. by adding by-subjects slopes. To do this add the <code>State</code> variable to the left side of the bar <code>|</code> in the random effects part of the formula.</p></li>
</ol>
<pre class="r"><code># Mixed effects model with by-subject random intercepts and slopes
subj_RI_RS_mod &lt;- lmer(XXX ~ XXX +          # These are the fixed effects
                      (XXX|XXX),            # These are the random effects
                      data = XXX,           # Specify the data used
                      REML = FALSE)</code></pre>
<ol start="9" style="list-style-type: decimal">
<li><p>Compare the outputs of the fixed effects only model, of the by-subjects random intercepts model, and of the by-subjects random intercepts and slopes model. Did the coefficients change? Why not? What did change?</p></li>
<li><p>Because each movie was rated in both states, there is also a repetition in the items. This again leads to a violation of the independence assumption. To account for this, we also have to include by-item (i.e. by-movie) random effects. Expand the model from task B8. by adding by-movie random intercepts and slopes. This is now the <em>maximal model justified by the design</em> as it incorporates all possible random effects structures.</p></li>
</ol>
<pre class="r"><code># Mixed effects model with by-subject and by-movie random intercepts and slopes
max_mod &lt;- lmer(XXX ~ XXX +           # These are the fixed effects
               (XXX|XXX) + (XXX|XXX), # These are the random effects
               data = XXX,            # Specify the data used
               REML = FALSE)</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>Compare the results with those of the earlier models.</li>
</ol>
</div>
<div id="c---computing-p-values-for-fixed-effects" class="section level3">
<h3>C - Computing p-Values for Fixed Effects</h3>
<p>As you probably noticed, the <code>lmer()</code> summary output does not include p-values. This is not because the authors of <code>lme4</code> were lazy, but because how to best compute p-values for mixed effects models is a still ongoing discussion. However, several possibilities exist of how to test whether a variable is a significant predictor (i.e., for now, a significant fixed effect).</p>
<div id="likelihood-ration-test" class="section level4">
<h4>Likelihood Ration Test</h4>
<p>One possibility to obtain p-values is by running a likelihood ration test (<a href="https://en.wikipedia.org/wiki/Likelihood-ratio_test">LRT</a>). In an LRT, the model is fitted once with and once without the fixed effect of interest, all else being equal. These two models are then compared in using the LRT. However, LRTs tend to slightly underestimate the p-values of fixed effects, so if the p-value is just below the threshold (often .05), you may want to use a more accurate, more conservative method. This test is why we used <code>REML = FALSE</code> when fitting the mixed effects models.</p>
<ol style="list-style-type: decimal">
<li>For this test, we will use the a model with by-subject and by-item random intercepts, and compare it to the same model without the fixed effect of interest (i.e., without <code>State</code>). First, fit the intercept only model (<code>IO_mod</code>).</li>
</ol>
<pre class="r"><code># Intercept only mixed effects model with by-subject and by-movie random intercepts
IO_mod &lt;- lmer(XXX ~ 1 +         # There are no fixed effects so add 1 to fit the intercept
              (1|XXX) + (1|XXX), # These are the random effects
              data = XXX,        # Specify the data used
              REML = FALSE)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Look at the model output using <code>summary()</code>.</p></li>
<li><p>Now fit the by-subject and by-item random intercepts. Call this <code>RI_mod</code></p></li>
</ol>
<pre class="r"><code># Intercept only mixed effects model with by-subject and by-movie random intercepts
RI_mod &lt;- lmer(XXX ~ XXX +         # The fixed effects
              (1|XXX) + (1|XXX),   # These are the random effects
              data = XXX,          # Specify the data used
              REML = FALSE)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Perform an LRT using the <code>anova()</code> function, by entering both model outputs as arguments.</li>
</ol>
<pre class="r"><code># Perform an LRT using the anova() function
anova(XXX, XXX)</code></pre>
</div>
<div id="confidence-intervals" class="section level4">
<h4>Confidence Intervals</h4>
<p>This method is not a formal way of testing significance, as it does not produce a p-value. In this method, confidence intervalls are obtained and checked if they include zero. If they don’t, this is interpreted as a significant result.</p>
<ol start="4" style="list-style-type: decimal">
<li>We can obtain confidence intervals for our fixed effects using the <code>confint()</code> function of the <code>lme4</code> package. Do this by entering your <code>max_mod</code> into the <code>confint()</code> function.</li>
</ol>
<pre class="r"><code># Compute confidence intervals for the fixed effects
ci_mod &lt;- confint(XXX)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Print the <code>ci_mod</code> object. Do the confidence intervals you obtained match the conclusion you drew from inspecting the t-values and the LRT?</li>
</ol>
</div>
<div id="parametric-bootstrap" class="section level4">
<h4>Parametric Bootstrap</h4>
<p>Yet another test of significance, and the one you should prefer in an uncertain case (i.e., if p-values are on the border of your alpha-level), is to use parametric bootstrap, where, many times, data is resampled with replacement and then the model fitted again, to obtain an empirical distribution of the effect or parameter of interest. The drawback of this technique is that it can take rather long because it reestimates the model many times to generate a distribution.</p>
<ol start="6" style="list-style-type: decimal">
<li>For linear mixed effects models (fit using <code>lmer()</code>) you can also use the <code>PBmodcomp()</code> function from the <code>pbkrtest</code> package. Check out the help function of <code>PBmodcomp()</code> like this.</li>
</ol>
<pre class="r"><code>?PBmodcomp</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Now use the <code>PBmodcomp()</code> function to get p-values for the model. As you surely noticed from the help page, you will have to specify a smaller model against which to test. Use <code>IO_mod</code> for this. Also, because this procedure can take rather long, only use 100 simulations (when you perform your “real” analyses you may want to increase this number to 1000 or more).</li>
</ol>
<pre class="r"><code># perform parametric bootstrap
pb_mod &lt;- PBmodcomp(XXX, XXX, XXX = XXX)</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Print the <code>pb_mod</code> object and inspect the results. Are the results different from the other tests you’ve performed before?</li>
</ol>
</div>
<div id="other-tests" class="section level4">
<h4>Other Tests</h4>
<ol start="9" style="list-style-type: decimal">
<li>Another way of obtaining p-values with the t-statistic and a <a href="https://en.wikipedia.org/wiki/Wald_test">Wald test</a> by using the <code>p_value()</code> function of the <code>sjstats</code> package. Enter <code>max_mod</code> to the <code>p_value()</code> function.</li>
</ol>
<pre class="r"><code># Compute p-values for the fixed effects
p_value(XXX)</code></pre>
<ol start="10" style="list-style-type: decimal">
<li><p>As this test may not be appropriate for mixed effects models, we can extend the <code>p_value()</code> function with an additional argument <code>p.kr = TRUE</code>. Then the function will compute p-values based on conditional F-tests with <a href="https://www.jstatsoft.org/article/view/v059i09">Kenward-Roger approximation</a> for the degrees of freedom. Repeat the previous task by extending the function with <code>p.kr = TRUE</code> (Note that this approach is computationally rather expensive and thus will take a while to complete).</p></li>
<li><p>Compare the output of the tasks C9. and C10. Did things change? The reason why not is that the assumptions were all satisfied as the data was simulated with these assumptions, but with noisier real life data this may look different.</p></li>
</ol>
</div>
</div>
<div id="d---determining-the-significance-of-random-effects-model-selection" class="section level3">
<h3>D - Determining the “Significance” of Random Effects (Model Selection)</h3>
<p>Just as we may be interested whether the fixed effects are significantly related to the outcome variable, we may also be interested whether the variance in the random effects is substantial, that is, whether it is significantly different from zero. This may help deciding whether a random effect should be included or not. You may remember the <em>keep it maximal</em> principle, which states that you should always specify the maximal random effects structure justified by the design to guard against type I error inflation (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3881361/">Barr, Levy, Scheepers, &amp; Tily, 2013</a>). However, the maximal model may come with a loss of power to detect fixed effects and it may make sense to select which random effects structure to use (<a href="https://www.sciencedirect.com/science/article/pii/S0749596X17300013">Matuschek, Kliegl, Vasishth, Baayen, &amp; Bates, 2017</a>). To express it with the words of Matuschek and Colleagues: “[A] parsimonious mixed model […] containing only variance components supported by the data improves the balance between Type I error and power” (p. 305). To select which model to use, we will use LRTs.</p>
<p>When performing this LRT, we cannot use the usual alpha limit of .05. To see why, read the following quote from <a href="https://www.sciencedirect.com/science/article/pii/S0749596X17300013">Matuschek and colleagues (2017; p. 308)</a></p>
<blockquote>
<p>Within the context of model selection, it is important to resist the reflex of choosing <span class="math inline">\(\alpha_{LRT} = 0.05\)</span>. The <span class="math inline">\(\alpha_{LRT}\)</span> cannot be interpreted as the ‘‘expected model-selection Type I error-rate” but rather as the relative weight of model complexity and goodness-of-fit. For example, choosing <span class="math inline">\(\alpha_{LRT} = 0\)</span>, an infinite penalty on the model complexity is implied and consequently the minimal model is always chosen as the best, irrespective of the evidence provided by the data. Choosing <span class="math inline">\(\alpha_{LRT} = 1\)</span> implies an infinite penalty on the goodness-of-fit, and the maximal model is always chosen as the best. Therefore, choosing <span class="math inline">\(\alpha_{LRT} = 0.05\)</span> may imply an overly strong penalty on the model complexity and hence select a reduced model even if data favor a more complex one.</p>
</blockquote>
<p>We will follow their example and use <span class="math inline">\(\alpha_{LRT} = 0.2\)</span>. As the <code>anova()</code> function uses <span class="math inline">\(\alpha = 0.05\)</span> we will have to implement this procedure ourselves.</p>
<ol style="list-style-type: decimal">
<li>First, we have to fit the model whose complexity is one step lower compared to the maximal model. Think about which model this would be and write down the answer as a comment in your script. Don’t cheat by looking at the next task!</li>
</ol>
<pre class="r"><code># This is just a placeholder to increase the space to the next task to make it 
# easier to not cheat.

# There is nothing to see here...

# Just a random sidenote (which is actually very interesting, so you may want to
# to read on even if this kind of defies the purpos of this part to prevent you from
# looking at the answers first; so consider first completing the task and then reading
# the random but somehow terribly interesting sidenote):
#     Did you know that the reason why R uses the arrow &quot;&lt;-&quot; as assignment
#     operator is because it is based on S, which in turn is based on APL.
#     Now apparently, APL was designed on a specific keyboard that had a
#     &quot;&lt;-&quot; key and there was no &quot;==&quot; implemented to test equality. So equality
#     was tested using &quot;=&quot; and &quot;&lt;-&quot; was chosen as asignment operator
#     (info obtained from this blogpost: https://colinfay.me/r-assignment/)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>The answer to the last task is that you can constrain the correlation of the random intercepts and random slopes to zero. To do this you can use the double bar <code>||</code> in the random effects structure, that is <code>(design_matrix||grouping_variable)</code>. Fit the maximal model but constrain the correlations to zero.</li>
</ol>
<pre class="r"><code># Constrained mixed effects model with by-subject and by-movie random intercepts and slopes
con_mod &lt;- lmer(XXX ~ XXX +             # These are the fixed effects
               (XXX||XXX) + (XXX||XXX), # These are the random effects
               data = XXX,              # Specify the data used
               REML = FALSE,
               control = lmerControl(optimizer = &quot;bobyqa&quot;)) # use a different optimizer
                                                            # to avoid non convergence</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>You can ignore the warning for now</li>
</ol>
<p>significance tests for random effects - LRT -&gt; conservative because on the boundary</p>
<p>also LRT but better approx than above (but only works for linear models -&gt; by Crainiceanu, C. and Ruppert, D. ( 2004 )) <code>exactRLRT(mm)</code></p>
<div id="confidence-intervals-1" class="section level4">
<h4>Confidence Intervals</h4>
<p>In the previous section we learned that we can, instead of computing a p-value, obtain confidence intervals for fixed effects and check if they include zero. For random effects we can do exactly the same.</p>
<ol style="list-style-type: decimal">
<li>You can obtain confidence intervals for the random effects with the same function you’ve used before for the fixed effects: teh <code>confint()</code> function of the <code>lme4</code> package. You should still have the output stored as <code>ci_mod</code>. Print this object again and inspect the confidence intervals of the random effects.</li>
</ol>
</div>
</div>
<div id="e---r2-and-residual-variances" class="section level3">
<h3>E - <span class="math inline">\(R^2\)</span> and Residual Variances</h3>
<p>When fitting statistical models, we are usually interested in how much systematic variation they can capture. In linear (mixed effects) models this is the <span class="math inline">\(R^2\)</span> value, for generalized (mixed effects) models, we can compute pseudo <span class="math inline">\(R^2\)</span> values. The <code>sjstats</code> package comes with methods to obtain such <em>goodness-of fit measures</em> for regression models.</p>
<ol style="list-style-type: decimal">
<li><p>To obtain the <span class="math inline">\(R^2\)</span> of our model, we will use the <code>r2()</code> function from the <code>sjstats</code> package. Look at the help menue of the function to get an overview of what models you can use it for.</p></li>
<li><p>Compute the <span class="math inline">\(R^2\)</span> of the</p></li>
</ol>
<p>get variances using the sjstats package (see <a href="ftp://cran.r-project.org/pub/R/web/packages/sjstats/vignettes/mixedmodels-statistics.html" class="uri">ftp://cran.r-project.org/pub/R/web/packages/sjstats/vignettes/mixedmodels-statistics.html</a>):</p>
<p>also r- squared and iccs: r2() and (latter possibly with adjusted = TRUE)</p>
<p>cod() -&gt; get Tjurs D for binary outcome models</p>
</div>
<div id="f---intra-class-correlation" class="section level3">
<h3>F - Intra-Class Correlation</h3>
<p>icc()</p>
</div>
<div id="g---crossed-versus-nested-random-effects" class="section level3">
<h3>G - Crossed Versus Nested Random Effects</h3>
<ul>
<li>crossed vs nested random effects</li>
<li>intro</li>
<li>examples -&gt; run both</li>
<li>use this example <a href="https://www.ssc.wisc.edu/sscc/pubs/MM/MM_MultRand.html" class="uri">https://www.ssc.wisc.edu/sscc/pubs/MM/MM_MultRand.html</a></li>
</ul>
</div>
<div id="h---visualize-your-model" class="section level3">
<h3>H - Visualize Your Model</h3>
</div>
<div id="i---generalized-mixed-effects-models" class="section level3">
<h3>I - Generalized Mixed Effects Models</h3>
</div>
<div id="x---advanced-xxx" class="section level3">
<h3>X - Advanced: XXX</h3>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<pre class="r"><code># EXAMPLE CODE</code></pre>
</div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
<table>
<thead>
<tr class="header">
<th align="left">File</th>
<th align="left">Rows</th>
<th align="left">Columns</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="">XXX</a></td>
<td align="left">Nrow</td>
<td align="left">Ncol</td>
</tr>
<tr class="even">
<td align="left"><a href="">XXX</a></td>
<td align="left">Nrow</td>
<td align="left">Ncol</td>
</tr>
</tbody>
</table>
<p>SHORT VERBAL DESCRIPTION OF DATA SETS</p>
<div id="variable-description" class="section level4">
<h4>Variable description</h4>
<table style="width:75%;">
<colgroup>
<col width="20%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">XXX</td>
<td align="left">XXX</td>
</tr>
<tr class="even">
<td align="left">XXX</td>
<td align="left">age in years at baseline</td>
</tr>
<tr class="odd">
<td align="left">wtkg</td>
<td align="left">weight in kg at baseline</td>
</tr>
<tr class="even">
<td align="left">hemo</td>
<td align="left">hemophilia (0=no, 1=yes)</td>
</tr>
<tr class="odd">
<td align="left">homo</td>
<td align="left">homosexual activity (0=no, 1=yes)</td>
</tr>
<tr class="even">
<td align="left">drugs</td>
<td align="left">history of intravenous drug use (0=no, 1=yes)</td>
</tr>
<tr class="odd">
<td align="left">karnof</td>
<td align="left">Karnofsky score (on a scale of 0-100)</td>
</tr>
<tr class="even">
<td align="left">oprior</td>
<td align="left">non-zidovudine antiretroviral therapy prior to initiation of study treatment (0=no, 1=yes)</td>
</tr>
<tr class="odd">
<td align="left">z30</td>
<td align="left">zidovudine use in the 30 days prior to treatment initiation (0=no, 1=yes)</td>
</tr>
<tr class="even">
<td align="left">zprior</td>
<td align="left">zidovudine use prior to treatment initiation (0=no, 1=yes)</td>
</tr>
<tr class="odd">
<td align="left">preanti</td>
<td align="left">number of days of previously received antiretroviral therapy</td>
</tr>
<tr class="even">
<td align="left">race</td>
<td align="left">race (0=white, 1=non-white)</td>
</tr>
<tr class="odd">
<td align="left">gender</td>
<td align="left">gender (0=female, 1=male)</td>
</tr>
<tr class="even">
<td align="left">str2</td>
<td align="left">antiretroviral history (0=naive, 1=experienced)</td>
</tr>
<tr class="odd">
<td align="left">strat</td>
<td align="left">antiretroviral history stratification (1=’antiretroviral naive’, 2=’&gt; 1 but ≤ 52 weeks of prior antiretroviral therapy’, 3=’&gt; 52 weeks’)</td>
</tr>
<tr class="even">
<td align="left">symptom</td>
<td align="left">symptomatic indicator (0=asymptomatic, 1=symptomatic)</td>
</tr>
<tr class="odd">
<td align="left">treat</td>
<td align="left">treatment indicator (0=zidovudine only, 1=other therapies)</td>
</tr>
<tr class="even">
<td align="left">offtrt</td>
<td align="left">indicator of off-treatment before 96±5 weeks (0=no,1=yes)</td>
</tr>
<tr class="odd">
<td align="left">cd40</td>
<td align="left">CD4 T cell count at baseline</td>
</tr>
<tr class="even">
<td align="left">cd420</td>
<td align="left">CD4 T cell count at 20±5 weeks</td>
</tr>
<tr class="odd">
<td align="left">cd496</td>
<td align="left">CD4 T cell count at 96±5 weeks (=NA if missing)</td>
</tr>
<tr class="even">
<td align="left">r</td>
<td align="left">missing CD4 T cell count at 96±5 weeks (0=missing, 1=observed)</td>
</tr>
<tr class="odd">
<td align="left">cd80</td>
<td align="left">CD8 T cell count at baseline</td>
</tr>
<tr class="even">
<td align="left">cd820</td>
<td align="left">CD8 T cell count at 20±5 weeks</td>
</tr>
<tr class="odd">
<td align="left">cens</td>
<td align="left">indicator of observing the event in days</td>
</tr>
<tr class="even">
<td align="left">days</td>
<td align="left">number of days until the first occurrence of: (i) a decline in CD4 T cell count of at least 50 (ii) an event indicating progression to AIDS, or (iii) death.</td>
</tr>
<tr class="odd">
<td align="left">arms</td>
<td align="left">treatment arm (0=zidovudine, 1=zidovudine and didanosine, 2=zidovudine and zalcitabine, 3=didanosine).</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<div id="packages" class="section level3">
<h3>Packages</h3>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Installation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidyverse</code></td>
<td align="left"><code>install.packages(&quot;tidyverse&quot;)</code></td>
</tr>
<tr class="even">
<td align="left"><code>lme4</code></td>
<td align="left"><code>install.packages(&quot;lme4&quot;)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>sjstats</code></td>
<td align="left"><code>install.packages(&quot;sjstats&quot;)</code></td>
</tr>
</tbody>
</table>
</div>
<div id="functions-1" class="section level3">
<h3>Functions</h3>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Package</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>lmer</code></td>
<td align="left"><code>lme4</code></td>
<td align="left">XXX</td>
</tr>
<tr class="even">
<td align="left"><code>glmer</code></td>
<td align="left"><code>lme4</code></td>
<td align="left">XXX</td>
</tr>
<tr class="odd">
<td align="left"><code>fixef</code></td>
<td align="left"><code>lme4</code></td>
<td align="left">XXX</td>
</tr>
<tr class="even">
<td align="left"><code>ranef</code></td>
<td align="left"><code>lme4</code></td>
<td align="left">XXX</td>
</tr>
<tr class="odd">
<td align="left"><code>anova</code></td>
<td align="left"><code>stats</code></td>
<td align="left">XXX</td>
</tr>
<tr class="even">
<td align="left"><code>confint</code></td>
<td align="left"><code>stats</code></td>
<td align="left">XXX</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<div id="further-reading" class="section level3">
<h3>Further Reading</h3>
<p>A nice and non-technical introduction to mixed effects models can be found in a chapter titled <a href="http://davidkellen.org/wp-content/uploads/2017/04/introduction-mixed-models.pdf"><strong>An introduction to linear mixed modeling in experimental psychology</strong></a> by <strong>Henrik Singmann</strong> and <strong>David Kellen</strong>.</p>
<p>A more technical introduction can be found in the mixed effects models chapter of <a href="https://projecteuclid.org/euclid.cbms/1462106081"><strong>Analysis of Longitudinal and Cluster-Correlated Data</strong></a> by <strong>Nan Laird</strong>.</p>
<p>A nice freely available tutorial on mixed effects models can be found <a href="https://www.ssc.wisc.edu/sscc/pubs/MM/MM_Introduction.html">here</a>.</p>
<p>A rather technical introduction to mixed effects model with <code>lme4</code> is given in <a href="https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf"><strong>Fitting Linear Mixed-Effects Models Using lme4</strong></a> by <strong>Douglas Bates</strong>, <strong>Martin Mächler</strong>, <strong>Benjamin Bolker</strong>, and <strong>Steven Walker</strong>.</p>
<p>One of the classic introductions to regression models, including mixed effects models, is <a href="https://www.cambridge.org/ch/academic/subjects/statistics-probability/statistical-theory-and-methods/data-analysis-using-regression-and-multilevelhierarchical-models?format=PB&amp;isbn=9780521686891"><strong>Data Analysis Using Regression and Multilevel/Hierarchical Models</strong></a> by <strong>Andrew Gelman</strong> and <strong>Jennifer Hill</strong>.</p>
<p>Another great introduction to regression, including mixed effects models, is <a href="https://xcelab.net/rm/statistical-rethinking/"><strong>Statistical Rethinking</strong></a> by <strong>Richard McElreath</strong>.</p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
